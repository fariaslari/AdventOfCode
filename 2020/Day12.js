let rawEntry = "E2\r\nL180\r\nS4\r\nR90\r\nS1\r\nF49\r\nN2\r\nF18\r\nN2\r\nL180\r\nS5\r\nL90\r\nE3\r\nN2\r\nF11\r\nL180\r\nN5\r\nW3\r\nL180\r\nW2\r\nN5\r\nF80\r\nR90\r\nF89\r\nN1\r\nL180\r\nN2\r\nR180\r\nE4\r\nR90\r\nS1\r\nL90\r\nN5\r\nR180\r\nN2\r\nF17\r\nL90\r\nE2\r\nF58\r\nW5\r\nL90\r\nW3\r\nN3\r\nF78\r\nL90\r\nN4\r\nL90\r\nF15\r\nW1\r\nR90\r\nS1\r\nW4\r\nR90\r\nF41\r\nW4\r\nS4\r\nF37\r\nE5\r\nS1\r\nE3\r\nF19\r\nR90\r\nS1\r\nW4\r\nS2\r\nE2\r\nL180\r\nF51\r\nW5\r\nR90\r\nF76\r\nE2\r\nF40\r\nN4\r\nR180\r\nE5\r\nN3\r\nF72\r\nS4\r\nR90\r\nF99\r\nE3\r\nF76\r\nW5\r\nR90\r\nE2\r\nS5\r\nR180\r\nF76\r\nN4\r\nL180\r\nF10\r\nF83\r\nS1\r\nF46\r\nL90\r\nS5\r\nE1\r\nS1\r\nF14\r\nN4\r\nE1\r\nR180\r\nE1\r\nR180\r\nS3\r\nF52\r\nL90\r\nS4\r\nL90\r\nW3\r\nF18\r\nS2\r\nF81\r\nL180\r\nF76\r\nL180\r\nW1\r\nS2\r\nF73\r\nN2\r\nF77\r\nW1\r\nF28\r\nL180\r\nN2\r\nF76\r\nL180\r\nW5\r\nF61\r\nN4\r\nE2\r\nR180\r\nS2\r\nL90\r\nF14\r\nR180\r\nN5\r\nE4\r\nF11\r\nE1\r\nL90\r\nN3\r\nE3\r\nF58\r\nW3\r\nF72\r\nW1\r\nN2\r\nW5\r\nF44\r\nL90\r\nW4\r\nF37\r\nL90\r\nF4\r\nW5\r\nN3\r\nF57\r\nN4\r\nL90\r\nS2\r\nF43\r\nS4\r\nW3\r\nS5\r\nF84\r\nS2\r\nL90\r\nN1\r\nR180\r\nW3\r\nL180\r\nN2\r\nW3\r\nR90\r\nN2\r\nR90\r\nF66\r\nL90\r\nF73\r\nE4\r\nS2\r\nL270\r\nW2\r\nE2\r\nS4\r\nE1\r\nR90\r\nW1\r\nF49\r\nL270\r\nF70\r\nS3\r\nW1\r\nN2\r\nE1\r\nF65\r\nW3\r\nR90\r\nF27\r\nE5\r\nF80\r\nS4\r\nW5\r\nF68\r\nE5\r\nR90\r\nF94\r\nW2\r\nL90\r\nF37\r\nL180\r\nE1\r\nF38\r\nN2\r\nF15\r\nN4\r\nE3\r\nL90\r\nE1\r\nR90\r\nS1\r\nE5\r\nN4\r\nN2\r\nE4\r\nL270\r\nN4\r\nR90\r\nE1\r\nS4\r\nE4\r\nF71\r\nE2\r\nR180\r\nN5\r\nE3\r\nF17\r\nL90\r\nN2\r\nW1\r\nL90\r\nF62\r\nW1\r\nF85\r\nW1\r\nL180\r\nF33\r\nS4\r\nW1\r\nN5\r\nF81\r\nW2\r\nR90\r\nS2\r\nF49\r\nL180\r\nS5\r\nF4\r\nW4\r\nN3\r\nW1\r\nF17\r\nR90\r\nW4\r\nN4\r\nE4\r\nN3\r\nL90\r\nS2\r\nR90\r\nS3\r\nL90\r\nE4\r\nR90\r\nS5\r\nF88\r\nS1\r\nL180\r\nN5\r\nE5\r\nF55\r\nR90\r\nF81\r\nE5\r\nL180\r\nR90\r\nF55\r\nR90\r\nW5\r\nF13\r\nR90\r\nN5\r\nF58\r\nL180\r\nS5\r\nF27\r\nE4\r\nS3\r\nF42\r\nR90\r\nF39\r\nW3\r\nS3\r\nF31\r\nS4\r\nL90\r\nW1\r\nS3\r\nW3\r\nN4\r\nW2\r\nS3\r\nL90\r\nF61\r\nE1\r\nF23\r\nS2\r\nF31\r\nS3\r\nL180\r\nW1\r\nN1\r\nL90\r\nN3\r\nF81\r\nE2\r\nN1\r\nR90\r\nF64\r\nS4\r\nF88\r\nE1\r\nN5\r\nW1\r\nS3\r\nF10\r\nN5\r\nL90\r\nF58\r\nS1\r\nR90\r\nE3\r\nL90\r\nN4\r\nF94\r\nS1\r\nW1\r\nS4\r\nL90\r\nF51\r\nL180\r\nN4\r\nR90\r\nL90\r\nN4\r\nF66\r\nW2\r\nS3\r\nS3\r\nW4\r\nF68\r\nL90\r\nF42\r\nE1\r\nF43\r\nR90\r\nN3\r\nF20\r\nE1\r\nN3\r\nE4\r\nN3\r\nF4\r\nS4\r\nR180\r\nW1\r\nR270\r\nN3\r\nF86\r\nL90\r\nE5\r\nF84\r\nN3\r\nW3\r\nF16\r\nL90\r\nN2\r\nE3\r\nL90\r\nS5\r\nE5\r\nF53\r\nL270\r\nN2\r\nF91\r\nR90\r\nE5\r\nN4\r\nF57\r\nE5\r\nS5\r\nF61\r\nS4\r\nF89\r\nE3\r\nN3\r\nN5\r\nF3\r\nS5\r\nF59\r\nE5\r\nF66\r\nR180\r\nS1\r\nW1\r\nN2\r\nR180\r\nS4\r\nE2\r\nL90\r\nN1\r\nW2\r\nF13\r\nL90\r\nE5\r\nF6\r\nW3\r\nF78\r\nE1\r\nF7\r\nW1\r\nN4\r\nW5\r\nF58\r\nR90\r\nE4\r\nN3\r\nE5\r\nN3\r\nW1\r\nS3\r\nR90\r\nF16\r\nL90\r\nF93\r\nR270\r\nN5\r\nF2\r\nW1\r\nS3\r\nF54\r\nR270\r\nF18\r\nR180\r\nF95\r\nL90\r\nW1\r\nE4\r\nN2\r\nW1\r\nL90\r\nS2\r\nL90\r\nW2\r\nS4\r\nF92\r\nW2\r\nS3\r\nR180\r\nN5\r\nE3\r\nN5\r\nE5\r\nF22\r\nF88\r\nS3\r\nE2\r\nR90\r\nS5\r\nW1\r\nL90\r\nE4\r\nF77\r\nN1\r\nW3\r\nF14\r\nE3\r\nR90\r\nW1\r\nF21\r\nN1\r\nF58\r\nW4\r\nN2\r\nR90\r\nN2\r\nW4\r\nF68\r\nW5\r\nN3\r\nL90\r\nF22\r\nR90\r\nF90\r\nF84\r\nS5\r\nF30\r\nN1\r\nW4\r\nR90\r\nF17\r\nR90\r\nW4\r\nS5\r\nE2\r\nN1\r\nF92\r\nN2\r\nR180\r\nN5\r\nE2\r\nR90\r\nF38\r\nR90\r\nF15\r\nE5\r\nN4\r\nN4\r\nE4\r\nS4\r\nF92\r\nR90\r\nF22\r\nS3\r\nW4\r\nN3\r\nE1\r\nR180\r\nF96\r\nL90\r\nE1\r\nN1\r\nF9\r\nW2\r\nN4\r\nF17\r\nN2\r\nR90\r\nF76\r\nS2\r\nF5\r\nS5\r\nF34\r\nR90\r\nF7\r\nN4\r\nF83\r\nN5\r\nL90\r\nW1\r\nS3\r\nR90\r\nS3\r\nW2\r\nS3\r\nF51\r\nN5\r\nW4\r\nF8\r\nE3\r\nF10\r\nN5\r\nF39\r\nS3\r\nE2\r\nL90\r\nE5\r\nL90\r\nN5\r\nE2\r\nN3\r\nF42\r\nS3\r\nF38\r\nN5\r\nF19\r\nF97\r\nW2\r\nR180\r\nS4\r\nE4\r\nS2\r\nW3\r\nF39\r\nW4\r\nF70\r\nS1\r\nW1\r\nR90\r\nF41\r\nL90\r\nE1\r\nN1\r\nE3\r\nW5\r\nF13\r\nE4\r\nF2\r\nR180\r\nF27\r\nE4\r\nN2\r\nL270\r\nE1\r\nN3\r\nW4\r\nF81\r\nW3\r\nR90\r\nE1\r\nF57\r\nS5\r\nR90\r\nF13\r\nL180\r\nN5\r\nF98\r\nF32\r\nN3\r\nR90\r\nN3\r\nW3\r\nS3\r\nW3\r\nN4\r\nF73\r\nL180\r\nN1\r\nE4\r\nF7\r\nE4\r\nR90\r\nN4\r\nR90\r\nS2\r\nE5\r\nF32\r\nS2\r\nN5\r\nW3\r\nR90\r\nW5\r\nS2\r\nL90\r\nF4\r\nR270\r\nN5\r\nE3\r\nL90\r\nS5\r\nF24\r\nN4\r\nR90\r\nF27\r\nL90\r\nF16\r\nR90\r\nN2\r\nR90\r\nN3\r\nL90\r\nS3\r\nL90\r\nF85\r\nS3\r\nF47\r\nN1\r\nE1\r\nN3\r\nR270\r\nS2\r\nL90\r\nF50\r\nL90\r\nS2\r\nF23\r\nN4\r\nL180\r\nE3\r\nF91\r\nR90\r\nE1\r\nW4\r\nF81\r\nW5\r\nR90\r\nF46\r\nE1\r\nW1\r\nF91\r\nN5\r\nW5\r\nN3\r\nW1\r\nL90\r\nF60\r\nS2\r\nL90\r\nE1\r\nF82\r\nS3\r\nW5\r\nN5\r\nF90\r\nE3\r\nS1\r\nF61\r\nE4\r\nF98\r\nR180\r\nF8\r\nR270\r\nF73\r\nW4\r\nL90\r\nW5\r\nL90\r\nF86\r\nW5\r\nL180\r\nF61\r\nN5\r\nF88\r\nE2\r\nL270\r\nF90\r\nN5\r\nF21\r\nR270\r\nF40\r\nL90\r\nW1\r\nN2\r\nL90\r\nE2\r\nS5\r\nE2\r\nS1\r\nE5\r\nN3\r\nF51\r\nS1\r\nF58\r\nW3\r\nL180\r\nF13\r\nR90\r\nN1\r\nF79\r\nW2\r\nF61\r\nR90\r\nF22\r\nE2\r\nN5\r\nF1\r\nS4\r\nF99\r\nS1\r\nS3\r\nE2\r\nF97";

let instructions = rawEntry.split("\r\n").map(m => {
    let inst = m.match(/([A-Z])(\d+)/);
    return {
        dir: inst[1],
        value: Number(inst[2])
    }
});

let rotations = {
    N: 90,
    S: 270,
    E: 0,
    W: 180
};

let directions = {
    N: "N",
    S: "S",
    E: "E",
    W: "W",
    L: "L",
    R: "R",
    F: "F",

}

function moveWaypoint(inst, waypoint){
    let aux = inst.value * (inst.dir === directions.R ? -1 : 1);
    return (360 + waypoint + (aux % 360)) % 360;
}

function printDistanceWaypoint(waypoint, ship) {
    instructions.forEach(inst => {
        if (inst.dir === directions.N) {
            waypoint[rotations.N] += inst.value;
        } else if (inst.dir === directions.S) {
            waypoint[rotations.S] += inst.value;
        } else if (inst.dir === directions.E) {
            waypoint[rotations.E] += inst.value;
        } else if (inst.dir === directions.W) {
            waypoint[rotations.W] += inst.value;
        } else if (inst.dir === directions.F) {
            ship.east += waypoint[rotations.E] * inst.value;
            ship.west += waypoint[rotations.W] * inst.value;
            ship.south += waypoint[rotations.S] * inst.value;
            ship.north += waypoint[rotations.N] * inst.value;
        } else {
            waypoint = {
                [moveWaypoint(inst, rotations.E)]: waypoint[rotations.E],
                [moveWaypoint(inst, rotations.N)]: waypoint[rotations.N],
                [moveWaypoint(inst, rotations.W)]: waypoint[rotations.W],
                [moveWaypoint(inst, rotations.S)]: waypoint[rotations.S]
            }
        }
    });

    let vertical = Math.abs(ship.south - ship.north);
    let horizontal = Math.abs(ship.east - ship.west);

    console.log("What is the Manhattan distance between that location and the ship's starting position? \nA: ", vertical + horizontal);
}

function printDistance(currDir, east, west, south, north, rotation) {
    instructions.forEach(inst => {
        if (inst.dir === directions.N) {
            north += inst.value;
        } else if (inst.dir === directions.S) {
            south += inst.value;
        } else if (inst.dir === directions.E) {
            east += inst.value;
        } else if (inst.dir === directions.W) {
            west += inst.value;
        } else if (inst.dir === directions.L) {
            rotation = (rotation + inst.value) % 360;
            if (rotation === rotations.N) currDir = directions.N;
            if (rotation === rotations.S) currDir = directions.S;
            if (rotation === rotations.E) currDir = directions.E;
            if (rotation === rotations.W) currDir = directions.W;
        } else if (inst.dir === directions.R) {
            let aux = rotation - (inst.value % 360);
            rotation = (360 + aux) % 360;
            if (rotation === rotations.N) currDir = directions.N;
            if (rotation === rotations.S) currDir = directions.S;
            if (rotation === rotations.E) currDir = directions.E;
            if (rotation === rotations.W) currDir = directions.W;
        } else if (inst.dir === directions.F) {
            if (currDir === directions.N) {
                north += inst.value;
            } else if (currDir === directions.S) {
                south += inst.value;
            } else if (currDir === directions.E) {
                east += inst.value;
            } else if (currDir === directions.W) {
                west += inst.value;
            }
        }
    });

    let vertical = Math.abs(south - north);
    let horizontal = Math.abs(east - west);

    console.log("What is the Manhattan distance between that location and the ship's starting position? \nA: ", vertical + horizontal);
}

printDistance(directions.E, 0, 0, 0, 0, rotations.E);
printDistanceWaypoint({
    [rotations.E]: 10,
    [rotations.N]: 1,
    [rotations.W]: 0,
    [rotations.S]: 0
}, {
    east: 0,
    north: 0,
    west: 0,
    south: 0
});
